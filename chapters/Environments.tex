\chapter{配置环境}

\section{概述}
下表是目前经过测试的环境。如果有其他可用不可用的环境，欢迎补充。

\begin{table}[ht]
    \caption{经过测试的环境}
    % \label{tab:1}
    \begin{tabular}{ccc}
        \toprule
        OS & TeX & 测试情况 \\
        \midrule
        Windows 10 & \hologo{TeX}\,Live 2021 & ✔ \\
        Windows 10 & \hologo{MiKTeX} & ✔ \\
        Windows 10 & \hologo{TeX}\,Live 2020 & ✔  \\
        Ubuntu 20.04 & \hologo{TeX}\,Live 2021 & ✔ \\
        南大TeX\footnote{由于未知原因，南大TeX不能使用\hologo{XeLaTeX}编译，请务必选择\hologo{LuaLaTeX}进行编译。} & Overleaf & ✔ \\
        \bottomrule
    \end{tabular}
\end{table}

\section{本地编译}

\subsection{安装\hologo{TeX}发行版}

首先需要下载\hologo{TeX}软件发行版，校园网环境中使用\href{https://mirror.nju.edu.cn/download/app/TeX%20%E6%8E%92%E7%89%88%E7%B3%BB%E7%BB%9F}{南大镜像站}可以获得最好的体验。\textbf{推荐使用最新的\hologo{TeX}\,Live 2021或者\hologo{MiKTeX} 21以避免潜在的兼容性问题。}

\begin{itemize}
    \item 为了避免不必要的麻烦，请尽可能下载 full 版本，如 texlive-full。简而言之，下载大的那个。
    \item 并且，尽可能使用最新版（截至目前是 2021）。2020 及之前版本使用 PDF 格式的图片可能会出现加粗问题。
\end{itemize}

\subsection{配置前端}

推荐使用 VSCode + LaTeX Workshop（VSCode插件）完成论文编写，也可以使用其他编辑器，如 TeXworks、TeXstudio。

若使用 LaTeX Workshop 插件，本项目在\lstinline|.vscode/|中提供一份简易配置，可以直接使用。

\subsection{编译顺序}
应采用以下顺序进行编译，以生成正确的参考文献目录和编号。
\begin{enumerate}
    \item \hologo{XeLaTeX}/\hologo{LuaLaTeX}
    \item \hologo{biber}
    \item \hologo{XeLaTeX}/\hologo{LuaLaTeX}
    \item \hologo{XeLaTeX}/\hologo{LuaLaTeX}
\end{enumerate}

编译产物为\lstinline|njuthesis.pdf|。

\section{南大TeX在线编译}

理论上在\href{https://doc.nju.edu.cn/books/latex}{这个网站}能找到一段简介，实际上大家都鸽了。

\subsection{操作步骤}

1. 下载\href{https://github.com/nju-lug/NJUThesisUndergraduate/archive/refs/heads/master.zip}{模板全部文件}

2. 使用南京大学统一身份认证信息登录\href{https://tex.nju.edu.cn}{南大TeX}，点击New Project -> Upload Project上传刚刚得到的zip文件，上传后njuthesis.tex、njuthesis.cls等文件应在根目录，目录结构如\cref{{sec:directory}}所示

3. 在南大TeX项目内页面左上角的Menu中，将编译器改为\hologo{LuaLaTeX}

4. 编写TeX文档


\section{字体}

学校论文格式要求的字体一般已经在电脑上包含，如果遇到以下问题，可以依照给出的方案解决。

不同系统上的字体有所差别，实际输出结果可能会与其他环境有细微不同, 使用时请注意。

\begin{enumerate}
    \item Ubuntu 下遇到缺失字体 WenQuanYi Zen Hei Mono 或 Times New Roman的问题：
    
       安装对应字体即可。使用以下指令下载：
       
       \begin{lstlisting}
sudo apt install fonts-wqy-zenhei ttf-mscorefonts-installer
        \end{lstlisting}

    \item macOS 下提示 Package fontspec Warning: Font "STSong" does not contain requested Script "CJK"

       忽略即可，不影响使用。该警告已被抑制。
\end{enumerate}

\subsection{字体列表}

字体定义写于\texttt{profile/font.sty}

\begin{table}[htbp]
    \caption{默认字体清单}
    \label{tab:fontset}
    \begin{tabular}{cccc}
        \toprule
        类型 & Windows & macOS & Linux \\
        \midrule
        西文衬线 & Times~New~Roman & Times~New~Roman & TeX~Gyre~Termes \\
        西文无衬线 & Arial & Arial & TeX~Gyre~Heros \\
        西文等宽 & Courier~New & Courier~New & TeX~Gyre~Cursor \\
        宋体 & SimSun & Songti~SC~Light &FandolSong-Regular \\
        黑体 & SimHei & Heiti~SC~Light & FandolHei-Regular \\
        仿宋 & FangSong & STFangsong & FandolFang-Regular \\
        楷体 & KaiTi & Kaiti~SC & FandolKai-Regular \\
        \bottomrule
    \end{tabular}
\end{table}
